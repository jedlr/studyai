<!DOCTYPE html>
<html>
<head>
    <title>Study AI</title>
    <style>
        #loading {
            display: none;
        }
    </style>
</head>
<body>
    <body style="text-align: center; background-color: rgb(122, 215, 255);">
        <h1 style="text-align: center; rgb(84, 184, 230);">Study AI</h1>
    <i> Step 1: Please upload the file you wish to study :)</i><br><br>
    <form id="inputForm" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" id="file" required>
        <button type="submit">Upload File</button>
    </form>
    <hr style="width:100%;text-align:center;margin: left 2px;">
    <div id="result">
        <h3>Summary</h3>
        <ul id="summary"></ul>
        <!-- TODO -->
        <button id="newSumButton">Get New Summary</button>
        <br>
        <hr style="width:100%;text-align:center;margin: left 2px;">


        <h3>Comprehension Questions</h3>
        <ul id="questions"></ul>
        <!-- TODO -->
        <button id="newQuestionButton">Get New Question</button>
        <br>
        <hr style="width:100%;text-align:center;margin: left 2px;">

        <h3>Solutions</h3>
        <ul id="solutions"></ul>
        <!-- TODO -->
        <button id="newSolButton">Get New Solution</button>
        <br>
        <hr style="width:100%;text-align:center;margin: left 2px;">

        <h3>Citations</h3>
        <ul id="citations"></ul>  
        <hr style="width:100%;text-align:center;margin: left 2px;">
        <br>
        <div id="loading" style="font-size: 30px;">Loading...</div>

    </div>
    </body>
    <script>
        document.getElementById("inputForm").addEventListener("submit", function (event) {
            event.preventDefault();
            const fileInput = document.getElementById("file");
            const file = fileInput.files[0];
    
            const formData = new FormData();
            formData.append('file', file);
    
            document.getElementById("loading").style.display = "block"; // Show loading sign
    
            fetch("/process", {
                method: "POST",
                body: formData,
            })
                .then((response) => response.json())
                .then((data) => {
                    document.getElementById("loading").style.display = "none"; // Hide loading sign
                    document.getElementById("summary").innerHTML = data.result.replace(/\* /g, '<br>* ');
    
                    // Display comprehension questions
                    const questionsElement = document.getElementById("questions");
                    questionsElement.innerHTML = data.questions.map(question => `<li>${question}</li>`).join("<br>");
    
                    // Display solutions
                    const solutionsElement = document.getElementById("solutions");
                    solutionsElement.innerHTML = data.solutions.map(solution => `<li>${solution}</li>`).join("<br>");
    
                    // Display citations
                    const citationsElement = document.getElementById("citations");
                    citationsElement.innerHTML = data.citations.map(citation => `<li>${citation}</li>`).join("<br>");
                })
                .catch((error) => {
                    console.error("Error:", error);
                    document.getElementById("loading").style.display = "none"; // Hide loading sign
                });
        });
    </script>
    
</body>
</html>
